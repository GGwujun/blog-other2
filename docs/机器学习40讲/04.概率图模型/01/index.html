<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-other2/umi.3ec1f225.css" />
    <script>
      window.routerBase = "/blog-other2";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>28 | 最简单的概率图：朴素贝叶斯 - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/机器学习40讲/04.概率图模型/01" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-other2/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>大数据<ul><li><a href="/blog-other2/从0开始学大数据">从0开始学大数据</a></li></ul></span><span>架构师<ul><li><a href="/blog-other2/sre实战手册">sre实战手册</a></li><li><a href="/blog-other2/vim实用技巧必知必会">vim实用技巧必知必会</a></li><li><a href="/blog-other2/深入浅出云计算">深入浅出云计算</a></li><li><a href="/blog-other2/说透数字化转型">说透数字化转型</a></li><li><a href="/blog-other2/遗留系统现代化实战">遗留系统现代化实战</a></li></ul></span><span>工作生活<ul><li><a aria-current="page" class="active" href="/blog-other2/机器学习40讲">机器学习40讲</a></li><li><a href="/blog-other2/职场求生攻略">职场求生攻略</a></li></ul></span><span>杂谈<ul><li><a href="/blog-other2/aI技术内参">aI技术内参</a></li><li><a href="/blog-other2/人工智能基础课">人工智能基础课</a></li><li><a href="/blog-other2/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog-other2/实用密码学">实用密码学</a></li><li><a href="/blog-other2/手把手带你写一门编程语言">手把手带你写一门编程语言</a></li><li><a href="/blog-other2/深入浅出区块链">深入浅出区块链</a></li><li><a href="/blog-other2/说透区块链">说透区块链</a></li><li><a href="/blog-other2/超级访谈对话汤峥嵘">超级访谈对话汤峥嵘</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-other2/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>大数据<ul><li><a href="/blog-other2/从0开始学大数据">从0开始学大数据</a></li></ul></li><li>架构师<ul><li><a href="/blog-other2/sre实战手册">sre实战手册</a></li><li><a href="/blog-other2/vim实用技巧必知必会">vim实用技巧必知必会</a></li><li><a href="/blog-other2/深入浅出云计算">深入浅出云计算</a></li><li><a href="/blog-other2/说透数字化转型">说透数字化转型</a></li><li><a href="/blog-other2/遗留系统现代化实战">遗留系统现代化实战</a></li></ul></li><li>工作生活<ul><li><a aria-current="page" class="active" href="/blog-other2/机器学习40讲">机器学习40讲</a></li><li><a href="/blog-other2/职场求生攻略">职场求生攻略</a></li></ul></li><li>杂谈<ul><li><a href="/blog-other2/aI技术内参">aI技术内参</a></li><li><a href="/blog-other2/人工智能基础课">人工智能基础课</a></li><li><a href="/blog-other2/反爬虫兵法演绎20讲">反爬虫兵法演绎20讲</a></li><li><a href="/blog-other2/实用密码学">实用密码学</a></li><li><a href="/blog-other2/手把手带你写一门编程语言">手把手带你写一门编程语言</a></li><li><a href="/blog-other2/深入浅出区块链">深入浅出区块链</a></li><li><a href="/blog-other2/说透区块链">说透区块链</a></li><li><a href="/blog-other2/超级访谈对话汤峥嵘">超级访谈对话汤峥嵘</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-other2/机器学习40讲">机器学习40讲</a></li><li><a href="/blog-other2/机器学习40讲/01.开篇词">01.开篇词</a><ul><li><a href="/blog-other2/机器学习40讲/01.开篇词/01"><span>开篇词 | 打通修炼机器学习的任督二脉</span></a></li></ul></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观">02.机器学习概观</a><ul><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/01"><span>01 | 频率视角下的机器学习</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/02"><span>02 | 贝叶斯视角下的机器学习</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/03"><span>03 | 学什么与怎么学</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/04"><span>04 | 计算学习理论</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/05"><span>05 | 模型的分类方式</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/06"><span>06 | 模型的设计准则</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/07"><span>07 | 模型的验证方法</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/08"><span>08 | 模型的评估指标</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/09"><span>09 | 实验设计</span></a></li><li><a href="/blog-other2/机器学习40讲/02.机器学习概观/10"><span>10 | 特征预处理</span></a></li></ul></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型">03.统计机器学习模型</a><ul><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/01"><span>11 | 基础线性回归：一元与多元</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/02"><span>12 | 正则化处理：收缩方法与边际化</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/03"><span>13 | 线性降维：主成分的使用</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/04"><span>14 | 非线性降维：流形学习</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/05"><span>15 | 从回归到分类：联系函数与降维</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/06"><span>16 | 建模非正态分布：广义线性模型</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/07"><span>17 | 几何角度看分类：支持向量机</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/08"><span>18 | 从全局到局部：核技巧</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/09"><span>19 | 非参数化的局部模型：K近邻</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/10"><span>20 | 基于距离的学习：聚类与度量学习</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/11"><span>21 | 基函数扩展：属性的非线性化</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/12"><span>22 | 自适应的基函数：神经网络</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/13"><span>23 | 层次化的神经网络：深度学习</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/14"><span>24 | 深度编解码：表示学习</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/15"><span>25 | 基于特征的区域划分：树模型</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/16"><span>26 | 集成化处理：Boosting与Bagging</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/17"><span>27 | 万能模型：梯度提升与随机森林</span></a></li><li><a href="/blog-other2/机器学习40讲/03.统计机器学习模型/18"><span>总结课 | 机器学习的模型体系</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-other2/机器学习40讲/04.概率图模型">04.概率图模型</a><ul><li><a aria-current="page" class="active" href="/blog-other2/机器学习40讲/04.概率图模型/01"><span>28 | 最简单的概率图：朴素贝叶斯</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/02"><span>29 | 有向图模型：贝叶斯网络</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/03"><span>30 | 无向图模型：马尔可夫随机场</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/04"><span>31 | 建模连续分布：高斯网络</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/05"><span>32 | 从有限到无限：高斯过程</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/06"><span>33 | 序列化建模：隐马尔可夫模型</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/07"><span>34 | 连续序列化模型：线性动态系统</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/08"><span>35 | 精确推断：变量消除及其拓展</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/09"><span>36 | 确定近似推断：变分贝叶斯</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/10"><span>37 | 随机近似推断：MCMC</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/11"><span>38 | 完备数据下的参数学习：有向图与无向图</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/12"><span>39 | 隐变量下的参数学习：EM方法与混合模型</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/13"><span>40 | 结构学习：基于约束与基于评分</span></a></li><li><a href="/blog-other2/机器学习40讲/04.概率图模型/14"><span>总结课 | 贝叶斯学习的模型体系</span></a></li></ul></li><li><a href="/blog-other2/机器学习40讲/05.结束语">05.结束语</a><ul><li><a href="/blog-other2/机器学习40讲/05.结束语/01"><span>结课 | 终有一天，你将为今天的付出骄傲</span></a></li></ul></li><li><a href="/blog-other2/机器学习40讲/06.加餐">06.加餐</a><ul><li><a href="/blog-other2/机器学习40讲/06.加餐/01"><span>如何成为机器学习工程师？</span></a></li><li><a href="/blog-other2/机器学习40讲/06.加餐/02"><span>结课测试 | 这些机器学习知识你都掌握了吗？</span></a></li></ul></li><li><a href="/blog-other2/机器学习40讲/summary">机器学习40讲</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="28--最简单的概率图朴素贝叶斯"><a aria-hidden="true" tabindex="-1" href="/blog-other2/机器学习40讲/04.概率图模型/01#28--最简单的概率图朴素贝叶斯"><span class="icon icon-link"></span></a>28 | 最简单的概率图：朴素贝叶斯</h1><p>从今天起，我们将进入概率图模型的模块，以贝叶斯的角度重新审视机器学习。</p><p>在机器学习任务中，输入和输出之间并不是简单的一对一的决定关系，两者之间通常存在着一些可见或不可见的中间变量。要计算输出变量的概率分布，就得把这些中间变量纳入到建模的框架之中。要简洁明快地表达多个变量之间的复杂的相关关系，<strong>图模型</strong>无疑是理想的选择。将图模型和概率模型结合起来，就是这个模块的主题——<strong>概率图模型</strong>（probabilistic graphical model）。</p><p>在“人工智能基础课”中，我曾用简短的篇幅粗略地介绍过概率图模型的概念和分类。这次我们从实例出发，看一看最简单的概率图模型——<strong>朴素贝叶斯分类器</strong>（naive Bayes classifier），并以它作为从统计机器学习到概率图模型的过渡。</p><p>还记得朴素贝叶斯的原理吗？回忆一下，朴素贝叶斯利用后验概率最大化来判定数据所属的类别，其“朴素”之处在于条件独立性的引入。条件独立性假设保证了所有属性相互独立，互不影响，每个属性独立地对分类结果发生作用，这样类条件概率就变成了属性条件概率的乘积。这在概率图中体现为<strong>条件独立关系（conditioanl independence）</strong>：如果将朴素贝叶斯模型画成有向图的话，它就是下图中的贝叶斯网络，<strong>类别信息指向所有的属性，任何两个属性之间都没有箭头的指向</strong>。</p><p><img src="/blog-other2/static/httpsstatic001geekbangorgresourceimage281828139c3d59da09084e2bff445327f818.45acac28.png" alt=""/></p><p>朴素贝叶斯的概率图模型（图片来自Probabilistic Graphical Models: Principles and Techniques，图3.2）</p><p>朴素贝叶斯的好处在于可以将属性和类别的联合分布表示成一个关于类的先验分布（prior distribution）和一组与属性相关的条件概率分布（conditional probability distribution）的乘积，这个过程被称为<strong>因子分解</strong>（factorization）。如果数据共有$N$个属性变量$X_i$，其分类结果为另一个变量$Y$，那么朴素贝叶斯的因子分解就可以表示为</p><p>$$ p(Y, X) = p(Y) \cdot \prod\limits_<!-- -->{<!-- -->i = 1<!-- -->}<!-- -->^N p(X_i | Y) $$</p><p>这种条件独立关系用概率图模型的术语来描述的话就是</p><p>$$ \forall i,(<!-- -->{<!-- -->X_i<!-- -->}<!-- --> \bot <!-- -->{<!-- -->{<!-- -->\bf X<!-- -->}<!-- -->_<!-- -->{<!-- --> - i<!-- -->}<!-- -->}<!-- -->|Y) $$</p><p>它的含义是属性$X_i$和其他所有属性关于类别$Y$条件独立。将这个式子和前面的示意图结合起来，可以发现因子分解的<strong>模块化特性</strong>（modularity）。当一个新的属性出现时，整体上的联合分布肯定会发生变化。但利用因子分解，生成新的联合分布只需要添加新属性关于输出的条件分布，而无需对原始分布的其他参数做出调整。在概率图模型中，这种操作就是添加一条有向边及其对应的结点这么简单。</p><p>朴素贝叶斯通过因子分解来计算样本属于每个类别的后验概率。反过来，它也可以依赖因子分解来生成新的数据，因而属于<strong>生成模型</strong>的范畴。在生成样本时，朴素贝叶斯首先按照先验分布抽取出一个类别，再按照类别下的条件概率分布生成不同属性的取值。</p><p><strong>在解决分类问题时，朴素贝叶斯在判别模型上的对应是逻辑回归</strong>，它体现出的是和朴素贝叶斯截然相反的思路。</p><p>逻辑回归的计算目标是分类边界，边界又是各个属性的线性组合，样本中每个属性的取值共同决定了样本。<strong>从图模型的角度观察，逻辑回归就是朴素贝叶斯的反转</strong>：朴素贝叶斯是类别变量$Y$中伸出若干个箭头指向每一个属性变量$X_i$；逻辑回归则是每个属性变量$X_i$都伸出一个箭头，共同指向类别变量$Y$。这意味着分类的输出依赖于属性的取值，根据这种依赖关系计算出来的是在不同的属性取值下，分类结果的可能性，也就是条件概率$p(Y | X)$。</p><p>朴素贝叶斯的运算流程在上一季中已经有过介绍，在这里简单地总结一下：先验分布就是训练数据集上不同类别的数据所占的比例；每一个条件概率分布可以利用最大似然估计来计算，其计算方式就是在同一个类别的所有数据中，统计属性为特定值的数据所占的比例。但这种方式有一个潜在的问题，当样本容量较小时，某些属性的取值可能压根儿没有出现过，导致计算出来的似然概率为0，从而与真实情况产生偏差。</p><p>要解决这个问题，传统的方法是在条件概率分布的计算中<strong>引入拉普拉斯平滑</strong>（Laplacian smoothing），而从纯贝叶斯方法的角度看，拉普拉斯平滑就是<strong>对隐含的参数引入先验分布</strong>。在贝叶斯方法中，参数的先验分布通常被设置为共轭先验。<strong>共轭先验</strong>（conjugate prior）是贝叶斯主义里的重要概念，指的是先验概率和后验概率具有相同的形式。</p><p>贝叶斯定理相当于用似然概率对先验概率进行加权得到后验概率，当先验概率和给定的似然概率共轭时，计算出的后验概率和先验概率将会服从同一分布，只是两者的参数有所不同。这就是引入共轭先验的好处：它将新概率分布的计算简化为新参数的计算，而无需重新确定分布的种类，从而降低了贝叶斯方法的运算复杂度。</p><p>看到这里，你是否想到了另一个相似的概念呢？<strong>共轭先验类似于线性代数中的特征向量，进一步推广就是信号理论中的特征函数</strong>。共轭先验相当于定义了一个函数空间，在这个空间上，作为泛函算子的似然概率作用在共轭先验上，定义了从先验到后验的演化过程，使输入和输出具有相同的形式。但这更大程度上是一种用于简化后验概率运算数学技巧，共轭先验本身并不能揭示关于数据机制任何潜在的规律。</p><p>既然共轭先验有这么容易计算，如何找到合适的共轭先验就成了下一个问题。可以证明，<strong>任何服从指数族分布的似然函数都存在共轭先验</strong>。在多分类问题中，每个样本都归属于多个类别中的一个，而属于每个类别的概率之和等于1，因此类的先验分布可以看成是二项分布的推广，叫作<strong>多项分布</strong>（multinomial distribution）或者<strong>类别分布</strong>（categorical distribution），其最典型的代表就是掷骰子得到的分布。<strong>狄利克雷分布（Dirichlet distribution）就是类别分布的的共轭先验</strong>，其表达式可以写成</p><p>$$ Dir(<!-- -->{<!-- -->\boldsymbol \alpha<!-- -->}<!-- -->) = \dfrac<!-- -->{<!-- -->\Gamma(\sum_<!-- -->{<!-- -->i = 1<!-- -->}<!-- -->^k \alpha_i)<!-- -->}<!-- -->{<!-- -->\prod_<!-- -->{<!-- -->i = 1<!-- -->}<!-- -->^K \Gamma(\alpha_i)<!-- -->}<!-- --> \prod\limits_<!-- -->{<!-- -->i=1<!-- -->}<!-- -->^K x_i ^ <!-- -->{<!-- -->\alpha_i - 1<!-- -->}<!-- -->, \sum\limits_<!-- -->{<!-- -->i=1<!-- -->}<!-- -->^K x_i = 1 $$</p><p>其中$<!-- -->{<!-- -->\boldsymbol \alpha<!-- -->}<!-- -->$是狄利克雷分布的参数，$\Gamma(\cdot)$表示伽马函数（gamma function）。利用因子分解后的似然概率对因子分解后的先验概率进行加权，其作用就是对先验分布的参数加以修正。狄利克雷分布的参数被修正为$N_i + \alpha_i$，其中$N_i$是每个类别中的样本数目。当$\alpha = 1$时，这些先验就等效为拉普拉斯平滑。</p><p>下面这个例子给出了关于贝叶斯朴素贝叶斯很好的说明，它来自大卫·巴伯（David Barber）的著作《贝叶斯推理与机器学习》（Bayesian Reasoning and Machine Learning）中的例10.3。这个例子是这样的：</p><p>“问题的任务是判断一个人到底是英格兰人还是苏格兰人，判断的依据是五个二元属性，从上到下分别是爱吃奶油酥饼、不喜欢拉格啤酒、喝威士忌、吃粥和不看英格兰的足球比赛。在训练数据中包括左侧6个英格兰人和右侧7个苏格兰人的属性列表。现在来了一个新的五元组$<!-- -->{<!-- -->\bf x<!-- -->}<!-- --> = (1,0,1,1,0)^T$，那这个人是苏格兰人的可能性有多大呢？”</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmcAAACxCAMAAAC2lOo4AAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAALuUExURf///yMfIP///PTZuJV1Y19pcnd1b2RWYHiavt70/P///vrov4pQXpXY9///+OnCiVJRltn+//702LmUd2BcaXZ1dXFiWV92mr7e8v7////65cOIWlOU1P//++/IjFIzVYrI6//+68iJVTZPjMju+//+9erazLiZdlIxJSMfRorO9f706NvNtpt1UTQgICM7iM/8//7uxIpPPVKJxO/+//Xq2863mXdPNSQfJT+IzPz///7orGUqKEWIyfj////4yYpCKC1jrOj+//K9hVNPXGt7iZurl3E4Jf//676CWlJban2Imq2abzsfIP/+4q1jNSRCic74/v//8s6ISyQqaK3o+//xvoRRUV5peoqapZtvPyMfJSQgUf//9dOOTSQgS4rN8v/8zIo7JfzOiD8fIPjNiUUgKEyU1PzTjkYgJ8+IRv/8z5BDJyMkZa3s/OysZSgfJ0aOzyQfMGSs5f/srWQkICRDjtP8//7ioVghICVWoeP+///+3KJWLSMhXKLi+igfICMscbnx/iMfOHG46iMfMPK4cTAfIP/xt3EsIYpCJygfIjd8wvf//yM0fcT3/iQfP37D7///78R8PyMgS0UgIvfDfTcfJ/7ipWAqJz18v/L////yv346JyxXn97+///+3ahdNCQ6fsPy/v//7MN8QyQpXqLe+P/3wn40IiMfPzcfICMfIpV1YFhib2RWXnGOtNn0/P7ZoWZNTlBNRTs3QU9NTlBNTk9BP0RMTlBNUWah1///99mhbFBGPDo/S1BNS0Q/Q1BNbKLZ919WY3F1dV5vkLTZ8f/+16JkUVBNTUk4OUJMTlBMQ0JBS1Bkof/+8dm4lnddX2t1dndvY1hceZu93PT+/+isaC0gS0UgNWWs4iRJlEYgIChirez/////5a1iMCMgTZDT9f//+uOhXCUfJSMfLVih3CMfITBvtyUfIf//6rlvOEUgIP//+eOmZC0gQ37C7PLCfj0gMFmh2XdcWWRvdVhbcZCz14rDNCsAAAABYktHRACIBR1IAAAAB3RJTUUH5wkdCDgL5qhYYgAAAWV6VFh0UmF3IHByb2ZpbGUgdHlwZSB4bXAA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" alt=""/></p><p>上例中的训练数据集（图片来自Bayesian Reasoning and Machine Learning）</p><p>直接用朴素贝叶斯方法来求解这个问题的方法比较简单，容易计算出类先验概率$p(<!-- -->{<!-- -->\rm scottish<!-- -->}<!-- -->) = 7 / 13, p(<!-- -->{<!-- -->\rm english<!-- -->}<!-- -->) = 6 / 13$。在每个类别上又可以计算出相互独立的属性条件概率，将所有这些概率代入贝叶斯定理中就可以得到，这个人是苏格兰人的概率是0.8076，你可以自己验算一下。</p><p>可是用纯贝叶斯方法来解决这个问题，那就没那么简单了。出于简化运算的目的，这个例子没有给类分布设定先验，而是令属性关于类别的所有条件概率都服从相互独立的狄利克雷先验分布。由于狄利克雷分布是多项分布的共轭先验，而属性关于类别的二项分布又可以看成是多项分布的特例，因此根据先验计算出来的后验概率也服从狄利克雷分布，只是参数会有所变化。</p><p>假定属性的条件概率$\theta_s^i © = p(x_i = s | c)$表示当数据的类别为$c$时，第$i$个属性的取值为$s$的条件概率。由于数据类别为2，属性数目为5，属性取值为2，条件概率的总数就是$2 \times 5 \times 2 = 20$，每个条件概率都对应一个无信息的均匀狄利克雷分布的超参数$u_s^i © = 1$。根据狄利克雷分布的性质，计算出的后验概率的超参数可以写成</p><p>$$ <!-- -->{<!-- -->\hat u<!-- -->}<!-- -->_s^i © = u_s^i © + \sum\limits_<!-- -->{<!-- -->n: c^n = c<!-- -->}<!-- --> \mathbb<!-- -->{<!-- -->I<!-- -->}<!-- -->[x_i^n = s] $$</p><p>这么一大堆让人眼花缭乱的符号表达的就是一个意思：在每个类别$c$中计算每个属性$i$等于每个值$s$出现的次数，再将计算结果加在三元组$c, i, s$所对应的原始参数$u_s^i ©$上。比方说，在$c=0$的英格兰人中，所有样里本$i=1$的第一个属性中，$s=0$的样本有3个，相应的$u_0^1(0)$就被更新为$3 + 1 = 4$了。</p><p>更新之后的参数就可以用来计算后验概率，计算出的后验概率将进一步被用于新样本的分类，其数学推导比较复杂，感兴趣的话你可以参考原书。利用狄利克雷分布的数学性质可以求出，新样本$<!-- -->{<!-- -->\bf x<!-- -->}<!-- --> = (1,0,1,1,0)^T$是苏格兰人的概率是0.764，这略低于非贝叶斯方法求出的结果。</p><p>在Scikit-learn中，实现朴素贝叶斯分类器的是naive_Bayes模块。由于前面例子中的属性都是二值属性，因此需要调用模块中的BernoulliNB类。在使用这个类时需要注意的是其中的参数$\alpha$，这个参数的默认取值为1.0，表示对数据进行拉普拉斯平滑，将它设定为0则是直接利用数据进行计算。</p><p>利用这个类去处理上面的例子你会发现，$\alpha =0$得到的是一般朴素贝叶斯的结果，$\alpha=1$得到的则是贝叶斯朴素贝叶斯的结果。这也验证了拉普拉斯平滑的作用实际上就是给类别设定均匀分布的共轭的先验。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmAAAAAlCAYAAADlYVUmAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAGYktHRAD/AP8A/6C9p5MAAAE7elRYdFJhdyBwcm9maWxlIHR5cGUgeG1wAAAoz31SS3bDMAjcc4oeAYME0nFcS9r1vS57/A5KGjuOG/P84zfDIPr5+qaPuLQy6eZFVy/WnK1Z9mSLcPzbZt01YtpEbLFkw8Syrjf/I3uICNPeBs7PKMkltczCSW04CoU1S9eEm0W08yocBgqC5qZrlpQo2Qn/FgwOxROMdQXm8HlJdyRJnxAuQxetYTJIWQUOwbPdmuCtXtEWtL1IC4AI71zOjFKyTK6mcNQ5WoUKHQzvCdBFgA0lgiGEeGp0NC+0DwXpClpdjDU59V1ufEM/a4jca2K0ZYo4Xqn/DfAAWDODebFsGxYS/LG3AIlJyLp2TMdadNsR3hdFzRmU3qDWqwaq6leQ9H/JeUcyjls6L4mOJcfkOGTJIja9L6c/IvQLzjS6obey4IEAAAABb3JOVAHPoneaAAAbT0lEQVR42u2de3BV1b3HP945acEBJPi4wh3A+roa5XGFXhxHRmSi1mkrRDtUHYKVq8RpHU1w6jXR2iHWe006KnEcSR1DIg/bSaCgDgUrMhCECUICDa/YktRCE2rSm5PhRHMwZ+Z3/1h7c/Y52XvtffY5IQH2d+bMOWevvX7ru37r91t77fW8SESEAHrsL4cH/xseLIbP/xf2A6s74T8vHwIuL8GD34bPnx1qrQQIECCAR0Thv0YC1VD1k6Emk1mc7edD8Aw4b3BR0ADzgih8fgT+0gbf+lf4j+/C5SOGhkpvB7QD/z5hqJUSIECAAN5xsgPGn4/11ll+PgTPgPMGQQMsQIAAAQIECBDgLONfhppAgAABAgQIECDAhYbQUBM4pxCDKDAiVa35jRcgQDLOd1s63/MX5D11DCO9RHogZvk/ctTw4DUcEeuFiFVZIcgeNdSshhcSesC2rYSSciivMD7l8FIpbGmDyGHIugsiQ83YBX55eom35UUYfW/iPZEDkDVTffJXeo9nouukqlwyCTuZ6ZafX56DweVChs6W/CB6AkoWxW14XVtm5OrsRReWav4G09/PNjJdto6IQk0FvGTU9eu2Zr4OOif14oZemJcLV1g+bx9SQdETUHS/8Rwoh7BHkbEeKF+q4s1dCgd74mFOMmMn1bP5zHPaeFZvOxGPu21l3KdLNsav76yD+YbMuU9AU5cHmYa9WK+Xr4zbTMdumG+kVbQ23kBd89NEXV2R510vFwoSGmDfRKAvCiePwvOr4WQUunvgG4B+zh3t+eXpEm/GAvjtMhhtuTb6ZujeDh8tgOaI93gA9MKEH8Le3gzm3UlmOuXnl+dgcLnA4WhLfhCD4jz49WVwcAPseQVGxdIXq7UXF1tKOX/p2NIws8GMlq0OMVi1GrrHAF/CQ8/B0xuHOvfDQC9uMHq6tm2F/n3q89R0oAcezIM3p0PLe0AtXFGS2FPmhNqn4HmgpRZurYeF7xoBGpmxGBxsgN2NxmcHPF8Lx/tU1C2lcM9bsP5daFkBk83EeuHVt2FhsZI5rRVm/UI1pLQyDXvZchRa/watbXDwn0pkrA0mPwU5L0DTq/Dm6/CzOhX2k1VxPXW/k6DCACbEBv2fi4RmiPRZrp06pK6dMu+R4QmTp8ndK0+/8Uw0rxCZujzFSP0id84QaexLMZ4PmWmVn1+eg8ElQOYQUeXzSSTDcnX2kmGb92tL6fr7OY0+owyMTL9f5KPuuhBh6K0hyV+6P1O21GwYU2V+4n8dKmaIVHyufh9bIxLKU7acksxWFXa0X0TCIlNniFTsd0+7oUwklCvSLS4yjXw32zhJc5VIqCDuPw3LlcxTSfcl+2kABdtJ+H1fq+/+5IBs+MtemDYTRs6EN3bHg6zdpVl3wZ4u98Zf9M+QXwJNO5TMrJlQcyAevq4EavbCeyWG3EXxbui/WeJk3Q9NPYk8/7QjztMqM9YV7/LNugvySy1d2w7xom0wd6bqui2ps89Lv801XbzICWjaBf8HNDfBwQPQdFi94Wwph/zKxPvXlUD5brTQyXQrPye9uMocBC6+bKnNsKXdcbvwIvM3S2Fnj3qTm78IOoDwXihaqU/vg1J4o051vedXwrpyJXtPj16fbjx1+dPZYOtWFW4OO9Qcdpdpvo5+uNUpUagpicvMuh9ajHEHJ//TlbsuLK38aWxJCwd/9+t/bmWrswmnvK8rgZI/JF1bGufix1ds8W13nm560XHxY5/p2nxrnbq+7aRPnXjEXxuBHLhxhErzySPq+tceusDGTIJnaqCrF9bXwIMPqZ6+VGSWLIDFL8ANIQgfgSPAo9MhFoWohsOBBsj5AWSjl2mi/ThEknquu/4Os6fHe7YuuQwIwxfDeUx7OMGuVWbXWjWvhWaIfNIq0rhG/e4WEekTWThDZEmturehSrXk3V4ArDIbjovUV1la3RJv9S9cI3Jsezw9M171ZyL9/SKby9T/djeZfSJLZohMXSbyRVjk2McDZdrG6xfp7BTZvMz5TbHRrgdME+/YJpElBUb+ikQKi0UKlyud9Rk9kJs7DTHG20ijS0+FTqZb+TnpRSdzsLika0upyKzIVW+gR43yrusQObpCpHC7Pr3KPHX/2g3qe+pykdJckbLPvNvZAJ466GzQeENdaOTvVKdK1wuaDf6hfJH64zZ5zBc5Fhbpi4g07xLp7Nf7n67ctbbkM39+9anzd7/+59fHdHlvN+47ZtSJJrfmPvHtK9InMm+GSOkakYoiJe8LS5gTT61edFz82meaNn9sk+JX3+khLS9w6AFrKBOZukJEIiq9ik1Kv156oaQzbjOhgnjZeZVZVyASKo73QDWuUPcXFsTlFtYOTHatWe42vVrJMs2yPcMzX6Sx05JevkinKK6lufa+EvSA2SPlBlhDWP3vs9xzar9RqZaJVKwQKS3y1gVryjQLy3Rw08Ar80TuNB0vIvLJLmUUjSsSuz0lorpdN3foZXbuUr9Nf0zIgwsXEf0wY6MmTBfPOhRgRV2BSKhI/d6c4hCBnUxd+en04sYz01zStaVUZTYuF5lXJVJRILIwX2RhlUh1gcjaVn16lXkiSz6OP4Q6RaQ6V6Rsvzc7s+PpBU62ZFaoS5aLNB73KMzk1yFSacQv3GBcDCufqg8PvF/nf7py9xKWav786tPN3/34X7o+5pT3whkiSzYZesgXubPKSG+/P1850wCrEqkwGs8Vu1SQG08nvbhxScc+B8PmfUHTAJu3wuCzTM4Ms5ftdxf5/jI1ZFe5XOWlbLt3mUdrkxrPItJovEgsWaP8s8+on+os+qkuUI3jdhsftJNpRfdxkdI8Fd98sSjLjzfOipcPfG6KBA0wJ6Q2Jy4bcsaqn3ZDbo/eDWP7gVth/hNwlZfNgLPhOnNpqiH0EoPV6QjMzzXCRsHc2yzxLrb8DsGlwDcxvcwTzcCk+GTO7pMk9r9quDjl2Qsc45ndtDEGzE6c/zyQBzU7YFU9vL7ZY2IamU7l56oXncwMczHh15ZSlRm5CTY9B5ty4NgLcO3D8Dtgj8sm06cjcNN4I2/ZSl2nverThacOTvc//BrMOQxrqmBWHszOhz8+7a24RoyHgtfgjo0w5Vew+HswpV8NZTjy0/mfrtxdbCnV/KWlT42/+/Y/vz6m4V5YCte+CEXXwiNH4NO3EsP9+Mop4PuL4JYQ/OhmNZE6f587Tze9OHFJxz4Hw+YziYsvg01vwSagZR/Qq4bZr75UHy96GB74QE3qnz0W7pgMU56Bez/1ILMLflwGb75rmWQPXHmN+n7yAaWH0NXwMtD2D2AifLAUHv8aOn9vM/ToINOK7IlQ/AqUPgx/7oVZo+DZVbA0CoyAUBv8ejVcHMy29wTvG7EmrzayeMXoq2A2sOufcMt34ZbpkNUPWV7kho15EF1Q+gjkLIAbLBVI1Mb7Jk4F6qHeWHbbtB52AtMm6mVeciVwHI70QMdemPwciUtrXLhkAZw2Vo0kccoCjmjCnOIBNLcYyZ+Mh4cmwof3wePPwM77YG6Kx4oNkKkpP1e9aHhmmotvW/Ipc9wkdU/OHJh8PTxpxPmOh4fYmWkO4UR9aPWp4ekFtrYUhT17YdxN8Oxr0FQEO1e7L9uP9UKLZel61rfU95gRwOXwc+CeUugwEutoUzJd/c+Azl6cwlLOXzr61Pi7L/9L08ec6onJd8NiYMrDMPsx9dCDNOtd4KuwsoHtW4FJ6oHtxtNJL1ouPu3Tt00Y6DoARaXQOsjzka6bo74Xl8I1wLa31MvLHRZ/sOPSn/RjjNEiygq5y4y0q//335TIZcI0yAE27lH/wwfUKsvcGyF2Ah6oh/Uvw8geCBsfE04yYz1wsM3QfQxqK1EvGoYdRnohNAJCUTV3LOcxmDJEJ/Wdc7DrFjt1aOBKhuRryf8796thiDPjxEWpzdsJzRCZV5Y4d6Myz7kb15xfYX42t3qQ2S9SlhcPqzPmCDT2uXMRMVZ8GOGV+53DKvanEK/Wkm5eUhdth8HTZTgsGXYyteWn0Ysnnpnkko4t+ZFpDMdUGyuR6stUl7/baGt1nkjZIVGrhXKVrGrTXt3sTMPTVZ92tmTM27Hab9l2d1nmsJv1U7nLckOnSGFuYrg5ZOfkf17sRRuWYv786tOLv6fqf2n7mKaeMIeGkoeE/fiK3ZyeBnPM0QNPJ73ofMyPffq1CRPmfCjTt9OGwxCkiI0/JA2JOnGpLkqMV7zJm0ydnbdvT9LLx5Y4STqzroJ0kmkX74y9RBLLfGqx/fzLYAjSHhk/CzLco1rDoz20gCOHYdwj0NGgukNDKXZbxqIQicLIsTDCJiwWst+lONwDo8fad1Xr4g0WzHwkc2qqhFm7IbJqYP78ytRBpxe/MtOJl4otDaVMXVqp5jkdRHuhL5bi7twx6OpSq6vGjYfRNvHM3b+T86LzP2u4nQ782ISv/LllX+Pv6fifEwbLJjJt1zqebnpx4jIY5aeVGYOuMFye4uiBc2Iw93Z4dgPMyR6YbqQLOiOqVz07BS6RLuiOwsXZcPmogWGOMjWI9UB7xF6m37x3hVVn3RXjE+0i2gNfRiBrBEyw5M/cCT8Ugu5muPaX0P3xMNjPbRhhSA/jjhyAcY9B5z77pbAXKj4oh7pD8Lsj8NGHMHf8UDMKEODCQeB/9rjg9RKF/NvVHFETr75jbMYaYABqFsHjRywXcqB7VdAAs2JIG2CxXjjaATdeH+yQa0XLDmj6CmbdBteMHWo2AQJcWAj8zx6BXgIEyCyGtAEWIECAAAECBAhwIcL7KsgAAQIECBAgQIAAGUEw8pcKYmopdMoTSP3GCxAgGee7LZ3v+TvbOFf0ea7wPNsYRnoxF+OYyORiivMN5gKEMwhBts1iiIQesG0roaQcyiuMTzm8VApb2tSKxay7vO/dMlTwy9NLvC0vwuh7E++JHIifRZa/0ns8E10nLftJZQh2MtMtP788B4PLhQydLflB9ASULIrb8Lq2zMjV2YsuLNX8Daa/p4wo1FTAS0Ydum5r5n07VWTaXs55nsOwjIaFXtzQC/Ny4QrL5+1DKsh6Bmh+eeJWeE6InVTtizNtDaO9sc2yL+G2lfF6qWSjGVGd32teL6qELktDp2O3Op83ayYUrU1sMMZ64meczl0KB3vcw9x47qxTZ5VmzYS5T0CTcf7pmp8m6uqKPHu9JDTAvolAXxROHoXnV8PJKHT3wDcwcJPB4Qy/PF3izVgAv12WuIpj9M3QvR0+WgDNEe/xAOiFCT+Evb1kDk4y0yk/vzwHg8sFDkdb8oMYFOfBry+DgxtgzyswKpUddp2gsxcXW0o5f+nYUqZtMAarVkP3GOBLeOg5eHpjhtNIERm1l/OB5zAso2GhFzcYPV3btkL/PvV5ajrQAw/mwZvToeU9oBauKHHfqDsWg4MNsLvR+OyA52vheJ8K31IK97wF69+FlhWWnfmj0DkW9tRC06uw7R34n+2GzDZ1okPOCyrszdfhZ5ZD3GufUpvSttTCrfWw8F33MC3PXnj1bVhYrPI+rRVm/UI16H+yKq6n7ncSVJgIu83B+o0NGq177yVvpObjWMCzApOnyd0rT7/xTOjOe3SEcb5Xo+vOienLTKv8/PIcDC4BMoeIKp9PIumLSoDOXjJs835tKV1/t0Vf4jmX76d4hmuAs4CgjPzBYRPa7s8Sz/yszPd4HmkyjDMrj/bLmXNovRxmXpkbL7/mqsQzahuWJ24sWzFDpMLYCPfYmsRNoHVhjjyT0FCWuLGtCd0mtLaT8Pu+Vt8DTvXIhr/shWkzYeRMeGN3PMjaDZl1F+zpcm9UR/8M+SXQtEPJzJoJNQfi4etKoGYvvFdiyF0U74r9myVO1v3Q1JPI80874jytMmNd8a7GrLsgv9TSvesQL9oGc2eqrsaSOvu82J2AoosXOQFNu9T5Xs1NcPAANB1Wbw5byiG/MvH+dSVQvhstdDLdys9JL64yB4GLL1tqM2xpd9wuvMj8zVLY2aPenuYvgg4gvBeKVurT+6AU3qhT3d35lbCuXMne06PXpxtPXf50Nti6VYWbXfM1h91lmq9kH251ShRqSuIys+6HFmO8xsn/dOWuC0srfxpb0sLB3/36ny2+Hf/pZBNu6en8wUkvbvocDPvUxdOl58RzXQmU/CHp2lJvejkXyshNn+n4e2udur7tpE+deMRfG4EcuHGESvNJY9+vr1PsSS9ZAItfgBtCED6ijkR6dLraKDnqICvWAy1huPU69b/r7zB7eryn6ZLLgDB8YdRZYybBMzXQ1Qvra+DBh+I9i7owJ57JONAAOT9IcU9Tu0aeXYvNehzBJ63xYxLME9EXzhBZUmu0BKtUCzKVo4gajovUVyW2Ls3W9MI1Ise2x9Mz41V/JtLfL7K5TP1vd5NpHF8xdZnIF2GRYx8PlGkbr1+ks1Nk8zLnt6VGux4wTbxjm0SWFBj5KxIpLBYpXK50Zh4Rs9k47qG/NfEYGCfoZLqVn5NedDIHi0u6tpSKzIpc9eZz1Cjvug6RoytECl2OSqk0jmtZu8E4gmO5SGmuSNln3u1sAE8ddDZovJ0uNPJ3qlOl6wXNG+LH0dQnHZ9SmaeuHwuL9EVEmneJdPbr/U9X7lpb8pk/v/rU+btf/zOPtSpdI1JhHDHzhSXMySa06en8QVfuLvrMtH36rV90PNuN+44ZzwNTT8194rueGFZlpEOa/n7MOEKqvtNDWl7g0APWUCYydYWIRIxj+DYp/XrpvTJRVyASKo73XJnHNhUWxG2qsDZ+f/LRSO3WePkinaL4lOYm+W2nJV5Bkq3owhx4WrHWtCWbQF0PWMoNsIawUR6We07tNyrVMpGKFSKlRd66IU2ZpoJMIzcLuTJP5E7T+CIin+xSmW9ckdjVaJ5HtblDL7Nzl/pt2mRCHly4iOiHGRs1Ybp41u7wAYVdpH5vTrGb3E6mrvx0enHjmWku6dpSqjIbl4vMqxKpKBBZmC+ysEqkukBkrcv5f5V5Iks+jlfEnSJSnavOgvRiZ3Y8vcDJlswKYMlykcbjHoWZ/DpEKo34hRuMi2HlU8lnD4ro/U9X7l7CUs2fX326+bsv/zMf7lUiFUajtMI4W9PNx5zSc/MHt3K30+dg2Ge69YtTuRfOEFlinI+4Nl/kzipvejmXykiHwfB3X9A0wOatMPgskzNTDJzOcE6GecbpF5ZrjcbL0JI1qo7pM+rYOjOf/SKnIiLtn4uU5lkaRX0iZfmWczWXJ/r0+8vUEGHl8oFnh+rCnHiaqC5QDe52hzpN1wBLbRFpNuSMVT/thtwevRvG9gO3wvwn4Cov55Jlw3Xm8kxD6CUGq9MRmJ9rhI2CubdZ4l1s+R2CS4FvYnqZJ5qBSfGuxe6TJPYXarg45dkLHOOZy29iDJihN/95IA9qdsCqenh9s8fENDKdys9VLzqZGeZiwq8tpSozchNseg425cCxF+Dah9VRI3sm6JM6HYGbxht5y1bqOu1Vny48dXC6/+HXYM5hWFMFs/Jgdj788WlvxTViPBS8BndshCm/gsXfgyn9ahjAkZ/O/3Tl7mJLqeYvLX1q/N2v/50Cvr8IbgnBj25Wk4Lz97nbhFt6Tv7gVu52+hg0+/Rbv2jSKSyFa1+EomvhkSPw6Vve9HIulZEOg+HvmcTFl8Gmt2AT0LIP6FVTDK6+1EPkLvhxGbz5rmWSPXDlNer7yQdUfkJXw8tA2z+AiUAIRo+C0ddD8StQ+jA0l8Ato+DZVbA0CoyAUBv8ejVcHILoYXjgA7WIYPZYuGMyTHkG7v0Urmt1DpsywpknwAdL4fGvofP3/o5T9L4Ra/JqI4tljL4KZgO7/gm3fBdumQ5Z/ZDlRW7YmAvQBaWPQM4CuMHiRFEbC5w4FaiHemMpaNN62AlMm6iXecmVwHE40gMde2HycyQO9LpwyQI4rZ4hycPSWcARTZhTPIDmFiP5k/Hw0ET48D54/BnYeR/MTfFA2QEyNeXnqhcNz0xz8W1LPmWOm6TuyZkDk6+HJ4043/FQkZ9Zvh5O1IdWnxqeXmBrS1HYsxfG3QTPvgZNRbBztfvS9VgvtFiWfWd9S32PGQFcDj8H7imFDiOxjjYl09X/DOjsxSks5fylo0+Nv6fjf1+FlW63bwUmqYeIm485paf1Bw/lbqfPQbHPNOsXpzpy8t2wGJjyMMx+DGaN8qCXc6yMdPDr710HoKgUWgd5j43r5qjvxaVwDbDtLfXidoelLnDiEmlX995/U+L1CdMgB9i4R/0PH1ArFHNvVPO+Wi3z2uo3A9nwHcMuIr3qIPhQVM3XynlMNaLOmKPxY4zRWsoK6cN0PGMn4IF6WP8yjOxRh9CHe1JUoGOXWa7NEKTlWvL/zv1qGOLMOGpRavN2QjNE5pUlzjWozHPuyjTnGJifza0eZPaLlOXFw+qMcfLGPncuIsYqCyO8cr9zWMX+FOLVWtJNXnnRYfB0GQ5Lhp1Mbflp9OKJZya5pGNLfmQaQxLVxgqY+jLVle422lqdJ1J2SNSqmFwlq9q0Vzc70/B01aedLRlzV6z2W7bdXZY57Gb9VO6y3NApUpibGG4O2Tn5nxd70YalmD+/+vTi7yn7nzEX6IzcfJEGczzLg485paezXbdyt9XnINhn2vWLpo40h3+Sh8P91BPDsYx08Ovv5jwqs15LGw5DkCI2dUHSkKgTF51ttW9Pyt/HljhJea83pz5EEstganGiT1cXJcYr3uQtzImnHZdUV0Fm/CzIcI9qgY720IMQOQzjHoGOBtV9F0qx/zQWhUgURo6FETZhsZD9Tr3hHhg91r67VhdvsGDmI5lTUyXM2g2RVQPz51emDjq9+JWZTrxUbGkoZerSSjXP6SDaC32xFHeojkFXl1q1NG48jLaJZ+6AnZwXnf9Zw+104McmfOXPLfsaf0/H/5ygswm39Jxs169ezrZ9DlZ6mfbp4VRGOmhlxqArDJenOHLinBjMvR2e3QBzsgemG+mCzogaUcjOEJdYD7RH4OJsuNyyi3ysV6XVD/zb+MRyivbAlxHIGgETbNKLdEF3dKBMt7BUYe6EHwpBdzNc+0vo/njgwNKQHsYdOQDjHoPOff7GT89XfFAOdYfgd0fgow9h7vihZhQgwIWDs+1/gb8Pf1zwZRSF/NvV/FgTr75jbMYaYABqFsHjRywXcqB71TBrgMV64WgH3Hh9cCilFS07oOkrmHUbXDN2qNkECHBh4Wz7X+Dvwx9BGQUYDAxpA+yiiy5iCJMPECBAgAABAgQYEnhfBRkgQIAAAQIECBAgIwgaYAECBAgQIECAAGcZQQMsQIAAAQIECBDgLCNogAUIECBAgAABApxl/D/vaT2AFUzypAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wOS0yOVQwODo1NjoxNCswMDowMPxP45MAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDktMjlUMDg6NTY6MTQrMDA6MDCNElsvAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDIzLTA5LTI5VDA4OjU2OjE0KzAwOjAw2gd68AAAABd0RVh0eG1wOlBpeGVsWERpbWVuc2lvbgA2MDhXqZNXAAAAFnRFWHR4bXA6UGl4ZWxZRGltZW5zaW9uADM38Mm6CQAAAABJRU5ErkJggg==" alt=""/></p><p>使用BernoulliNB类对文中例子的计算结果</p><p>今天我和你分享了朴素贝叶斯方法的概率图表示，以及贝叶斯方法中共轭先验的概念，包含以下四个要点：</p><ul><li><p>朴素贝叶斯是最简单的概率图模型，具有发散的星型结构；</p></li><li><p>朴素贝叶斯能够计算属性和类别的联合分布，因而属于生成模型；</p></li><li><p>共轭先验可以保证先验分布和后验分布具有相同的形式和不同的参数；</p></li><li><p>拉普拉斯平滑的作用是给类别设定均匀分布的共轭先验。</p></li></ul><p>朴素贝叶斯是最简单的贝叶斯分类器，如果将属性之间相互独立的强限制放宽，得到的就是树增强朴素贝叶斯（tree augmented naive Bayes），它可以看成是朴素贝叶斯到通用的贝叶斯网络的过渡。</p><p>你可以查阅资料，了解树增强朴素贝叶斯的原理，并在这里发表你的见解。</p><p><img src="/blog-other2/static/httpsstatic001geekbangorgresourceimage6f656f08c36a1d6346b4b409fe2c3d036065.c79f9e37.jpg" alt=""/></p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/机器学习40讲/04.概率图模型/01.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/29 16:56:05</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-other2/umi.2006439a.js"></script>
  </body>
</html>
